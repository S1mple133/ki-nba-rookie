
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Random Forest &#8212; NBA Player Classification</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="prev" title="Data Visualisation" href="DataVisualisation.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
      
      
      <h1 class="site-logo" id="site-title">NBA Player Classification</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../README.html">
                    Introduction
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="DataAnalysisAndManipulation.html">
   Data Analysis and Manipulation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="DataVisualisation.html">
   Data Visualisation
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Random Forest
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/executablebooks/jupyter-book/master?urlpath=tree/chapters/RandomForest.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../_sources/chapters/RandomForest.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Random Forest</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="random-forest">
<h1>Random Forest<a class="headerlink" href="#random-forest" title="Permalink to this headline">#</a></h1>
<p>Use the Random Forest Algorithm to train and test a model.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">RandomForestClassifier</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span> 
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">metrics</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">cross_val_score</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">nba_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;../output/new_nba_data.csv&#39;</span><span class="p">)</span>
<span class="n">nba_data</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>GamesPlayed</th>
      <th>MinutesPlayed</th>
      <th>PointsPerGame</th>
      <th>FieldGoalsMade</th>
      <th>FieldGoalAttempts</th>
      <th>FieldGoalPercent</th>
      <th>3PointMade</th>
      <th>3PointAttempts</th>
      <th>3PointAttemptsPercent</th>
      <th>...</th>
      <th>FreeThrowAttempts</th>
      <th>FreeThrowPercent</th>
      <th>OffensiveRebounds</th>
      <th>DefensiveRebounds</th>
      <th>Rebounds</th>
      <th>Assists</th>
      <th>Steals</th>
      <th>Blocks</th>
      <th>Turnovers</th>
      <th>CareerLongerThan5Years</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>456</th>
      <td>Brandon Davies</td>
      <td>51</td>
      <td>11.3</td>
      <td>2.8</td>
      <td>1.1</td>
      <td>2.5</td>
      <td>42.2</td>
      <td>0.0</td>
      <td>0.2</td>
      <td>20.0</td>
      <td>...</td>
      <td>1.0</td>
      <td>64.2</td>
      <td>0.7</td>
      <td>1.4</td>
      <td>2.1</td>
      <td>0.5</td>
      <td>0.5</td>
      <td>0.2</td>
      <td>0.7</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>303</th>
      <td>Chris Washburn</td>
      <td>35</td>
      <td>11.0</td>
      <td>3.8</td>
      <td>1.6</td>
      <td>4.1</td>
      <td>39.3</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>1.5</td>
      <td>35.3</td>
      <td>1.0</td>
      <td>1.9</td>
      <td>2.9</td>
      <td>0.5</td>
      <td>0.2</td>
      <td>0.2</td>
      <td>1.1</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>772</th>
      <td>Devin Booker</td>
      <td>76</td>
      <td>27.7</td>
      <td>13.8</td>
      <td>4.8</td>
      <td>11.4</td>
      <td>42.3</td>
      <td>1.3</td>
      <td>3.8</td>
      <td>34.3</td>
      <td>...</td>
      <td>3.4</td>
      <td>84.0</td>
      <td>0.4</td>
      <td>2.1</td>
      <td>2.5</td>
      <td>2.6</td>
      <td>0.6</td>
      <td>0.3</td>
      <td>2.1</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1298</th>
      <td>Corie Blount</td>
      <td>67</td>
      <td>10.3</td>
      <td>3.0</td>
      <td>1.1</td>
      <td>2.6</td>
      <td>43.7</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>1.1</td>
      <td>61.3</td>
      <td>1.1</td>
      <td>1.8</td>
      <td>2.9</td>
      <td>0.8</td>
      <td>0.3</td>
      <td>0.5</td>
      <td>0.8</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>829</th>
      <td>Allan Ray</td>
      <td>47</td>
      <td>15.1</td>
      <td>6.2</td>
      <td>2.1</td>
      <td>5.5</td>
      <td>38.6</td>
      <td>1.0</td>
      <td>2.5</td>
      <td>41.4</td>
      <td>...</td>
      <td>1.2</td>
      <td>76.4</td>
      <td>0.4</td>
      <td>1.1</td>
      <td>1.5</td>
      <td>0.9</td>
      <td>0.4</td>
      <td>0.1</td>
      <td>0.9</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>262</th>
      <td>Milt Wagner</td>
      <td>40</td>
      <td>9.5</td>
      <td>3.8</td>
      <td>1.6</td>
      <td>3.7</td>
      <td>42.2</td>
      <td>0.1</td>
      <td>0.3</td>
      <td>20.0</td>
      <td>...</td>
      <td>0.7</td>
      <td>89.7</td>
      <td>0.1</td>
      <td>0.6</td>
      <td>0.7</td>
      <td>1.5</td>
      <td>0.1</td>
      <td>0.1</td>
      <td>0.6</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1147</th>
      <td>Adreian Payne</td>
      <td>32</td>
      <td>23.1</td>
      <td>6.7</td>
      <td>2.8</td>
      <td>6.9</td>
      <td>41.4</td>
      <td>0.0</td>
      <td>0.3</td>
      <td>11.1</td>
      <td>...</td>
      <td>1.4</td>
      <td>65.2</td>
      <td>1.5</td>
      <td>3.6</td>
      <td>5.1</td>
      <td>0.9</td>
      <td>0.6</td>
      <td>0.3</td>
      <td>1.4</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1181</th>
      <td>Ray Owes</td>
      <td>57</td>
      <td>10.4</td>
      <td>3.1</td>
      <td>1.3</td>
      <td>3.2</td>
      <td>41.7</td>
      <td>0.0</td>
      <td>0.1</td>
      <td>20.0</td>
      <td>...</td>
      <td>0.8</td>
      <td>56.5</td>
      <td>1.1</td>
      <td>1.7</td>
      <td>2.9</td>
      <td>0.3</td>
      <td>0.3</td>
      <td>0.3</td>
      <td>0.4</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>196</th>
      <td>Tom Garrick</td>
      <td>71</td>
      <td>21.1</td>
      <td>6.4</td>
      <td>2.5</td>
      <td>5.1</td>
      <td>49.0</td>
      <td>0.0</td>
      <td>0.2</td>
      <td>0.0</td>
      <td>...</td>
      <td>1.8</td>
      <td>80.3</td>
      <td>0.5</td>
      <td>1.7</td>
      <td>2.2</td>
      <td>3.4</td>
      <td>1.1</td>
      <td>0.1</td>
      <td>1.6</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>854</th>
      <td>Charlie Villanueva</td>
      <td>81</td>
      <td>29.1</td>
      <td>13.0</td>
      <td>5.4</td>
      <td>11.6</td>
      <td>46.3</td>
      <td>0.9</td>
      <td>2.6</td>
      <td>32.7</td>
      <td>...</td>
      <td>2.0</td>
      <td>70.6</td>
      <td>2.2</td>
      <td>4.2</td>
      <td>6.4</td>
      <td>1.1</td>
      <td>0.7</td>
      <td>0.8</td>
      <td>1.2</td>
      <td>1.0</td>
    </tr>
  </tbody>
</table>
<p>10 rows × 21 columns</p>
</div></div></div>
</div>
<p>The names of the players are not required for decisions, so we will be ignoring it</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nba_data</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;Name&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X</span> <span class="o">=</span> <span class="n">nba_data</span><span class="p">[</span><span class="n">nba_data</span><span class="o">.</span><span class="n">columns</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">nba_data</span><span class="p">[</span><span class="s1">&#39;CareerLongerThan5Years&#39;</span><span class="p">]</span>
<span class="n">train_X</span><span class="p">,</span> <span class="n">test_X</span><span class="p">,</span> <span class="n">train_y</span><span class="p">,</span> <span class="n">test_y</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span><span class="n">stratify</span><span class="o">=</span><span class="n">y</span><span class="p">)</span>
<span class="n">dt_model</span> <span class="o">=</span> <span class="n">RandomForestClassifier</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
<span class="n">dt_model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train_X</span><span class="p">,</span> <span class="n">train_y</span><span class="p">)</span>
<span class="n">pred_y</span> <span class="o">=</span> <span class="n">dt_model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">test_X</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Accuracy: </span><span class="si">{:.2%}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">metrics</span><span class="o">.</span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">test_y</span><span class="p">,</span> <span class="n">pred_y</span><span class="p">)))</span> 
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Recall: </span><span class="si">{:.2%}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">metrics</span><span class="o">.</span><span class="n">recall_score</span><span class="p">(</span><span class="n">test_y</span><span class="p">,</span> <span class="n">pred_y</span><span class="p">)))</span> 
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Precision: </span><span class="si">{:.2%}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">metrics</span><span class="o">.</span><span class="n">precision_score</span><span class="p">(</span><span class="n">test_y</span><span class="p">,</span> <span class="n">pred_y</span><span class="p">)))</span> 
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;F1 Score: </span><span class="si">{:.2%}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">metrics</span><span class="o">.</span><span class="n">f1_score</span><span class="p">(</span><span class="n">test_y</span><span class="p">,</span> <span class="n">pred_y</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Accuracy: 69.25%
Recall: 78.85%
Precision: 73.54%
F1 Score: 76.10%
</pre></div>
</div>
</div>
</div>
<p>The accuracy of 69% is pretty low. So let’s try using a Cross-Validation to see if the random split affects our test.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">scores</span> <span class="o">=</span> <span class="n">cross_val_score</span><span class="p">(</span><span class="n">dt_model</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">scoring</span><span class="o">=</span><span class="s1">&#39;accuracy&#39;</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">scores</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.6813432835820896
</pre></div>
</div>
</div>
</div>
<p>By using cross validation, the score is 68%. Let’s take a look at the Feature Importances.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">feature_importances</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">dt_model</span><span class="o">.</span><span class="n">feature_importances_</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">nba_data</span><span class="o">.</span><span class="n">columns</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="n">feature_importances</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>GamesPlayed              0.120035
PointsPerGame            0.072762
FieldGoalPercent         0.069790
FreeThrowPercent         0.063547
MinutesPlayed            0.060657
FieldGoalsMade           0.060537
FreeThrowMade            0.054399
FieldGoalAttempts        0.054145
DefensiveRebounds        0.051616
FreeThrowAttempts        0.050959
Rebounds                 0.048327
Assists                  0.046434
3PointAttemptsPercent    0.046243
OffensiveRebounds        0.044278
Turnovers                0.039989
3PointAttempts           0.033868
Blocks                   0.030166
Steals                   0.030091
3PointMade               0.022158
dtype: float64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">feature_importances</span><span class="o">.</span><span class="n">nlargest</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;bar&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;AxesSubplot: &gt;
</pre></div>
</div>
<img alt="../_images/RandomForest_9_1.png" src="../_images/RandomForest_9_1.png" />
</div>
</div>
<p>First, let’s try the train-validation-test method to play around with the hyperparameters. we’ll use a 70%-15%-15% split.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X_train</span><span class="p">,</span> <span class="n">X_test_full</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test_full</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
<span class="n">X_val</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_val</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X_test_full</span><span class="p">,</span> <span class="n">y_test_full</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([</span><span class="nb">len</span><span class="p">(</span><span class="n">y_train</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">y_val</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">y_test</span><span class="p">)],</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;train&#39;</span><span class="p">,</span><span class="s1">&#39;validation&#39;</span><span class="p">,</span> <span class="s1">&#39;test&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;pie&#39;</span><span class="p">,</span> <span class="n">subplots</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([&lt;AxesSubplot: ylabel=&#39;0&#39;&gt;], dtype=object)
</pre></div>
</div>
<img alt="../_images/RandomForest_11_1.png" src="../_images/RandomForest_11_1.png" />
</div>
</div>
<p>Let’s verify if the data has been split correctly.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">,</span> <span class="n">ax3</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<span class="n">y_train</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;pie&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax1</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;train&#39;</span><span class="p">)</span>
<span class="n">y_val</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;pie&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax2</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;val&#39;</span><span class="p">)</span>
<span class="n">y_test</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;pie&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax3</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;test&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;AxesSubplot: title={&#39;center&#39;: &#39;test&#39;}, ylabel=&#39;CareerLongerThan5Years&#39;&gt;
</pre></div>
</div>
<img alt="../_images/RandomForest_13_1.png" src="../_images/RandomForest_13_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dt_model</span> <span class="o">=</span> <span class="n">RandomForestClassifier</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span> 
<span class="n">dt_model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<span class="n">y_pred</span> <span class="o">=</span> <span class="n">dt_model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_val</span><span class="p">)</span>
<span class="n">accuracy_score</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_val</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Accuracy: </span><span class="si">{:.2%}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">accuracy_score</span><span class="p">))</span> 
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Accuracy: 65.12%
</pre></div>
</div>
</div>
</div>
<p>Let’s play with the hyperparameters and see if we can get a better result. Let’s start with max depth.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">train_and_find_best_depth</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">X_val</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_val</span><span class="p">,</span> <span class="n">do_print</span><span class="p">):</span> 
    <span class="n">result</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">accuracy_max</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
    <span class="k">for</span> <span class="n">curr_max_depth</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">20</span><span class="p">):</span>
        <span class="n">dt_model</span> <span class="o">=</span> <span class="n">RandomForestClassifier</span><span class="p">(</span><span class="n">max_depth</span><span class="o">=</span><span class="n">curr_max_depth</span><span class="p">,</span><span class="n">random_state</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span> 
        <span class="n">dt_model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
        <span class="n">y_pred</span> <span class="o">=</span> <span class="n">dt_model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_val</span><span class="p">)</span>
        <span class="n">accuracy_score</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_val</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">accuracy_score</span> <span class="o">&gt;=</span> <span class="n">accuracy_max</span><span class="p">:</span> 
            <span class="n">accuracy_max</span> <span class="o">=</span> <span class="n">accuracy_score</span> 
            <span class="n">result</span> <span class="o">=</span> <span class="n">curr_max_depth</span>
            <span class="k">if</span> <span class="n">do_print</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;max depth </span><span class="si">{}</span><span class="s1">: </span><span class="si">{:.2%}</span><span class="s1"> accuracy on validation set.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">curr_max_depth</span><span class="p">,</span> <span class="n">accuracy_score</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">do_print</span><span class="p">:</span> 
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;-&#39;</span> <span class="o">*</span> <span class="mi">20</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;best max depth </span><span class="si">{}</span><span class="s1"> has </span><span class="si">{:.2%}</span><span class="s1"> accuracy.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">result</span><span class="p">,</span><span class="n">accuracy_max</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">result</span>
    
<span class="n">best_max_depth</span> <span class="o">=</span> <span class="n">train_and_find_best_depth</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">X_val</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_val</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>max depth 1: 64.77% accuracy on validation set.
--------------------
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>max depth 2: 65.84% accuracy on validation set.
--------------------
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>max depth 3: 66.55% accuracy on validation set.
--------------------
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>max depth 4: 67.62% accuracy on validation set.
--------------------
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>max depth 5: 67.97% accuracy on validation set.
--------------------
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>best max depth 5 has 67.97% accuracy.
</pre></div>
</div>
</div>
</div>
<p>Let’s continue with n_estimators. AKA the number of trees in the forest.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">train_and_find_n_estimators</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">X_val</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_val</span><span class="p">,</span> <span class="n">do_print</span><span class="p">):</span> 
    <span class="n">result</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">accuracy_max</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
    <span class="k">for</span> <span class="n">n_estimators</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">100</span><span class="p">):</span>
        <span class="n">dt_model</span> <span class="o">=</span> <span class="n">RandomForestClassifier</span><span class="p">(</span><span class="n">n_estimators</span><span class="o">=</span><span class="n">n_estimators</span><span class="p">,</span><span class="n">random_state</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span> 
        <span class="n">dt_model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
        <span class="n">y_pred</span> <span class="o">=</span> <span class="n">dt_model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_val</span><span class="p">)</span>
        <span class="n">accuracy_score</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_val</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">accuracy_score</span> <span class="o">&gt;=</span> <span class="n">accuracy_max</span><span class="p">:</span> 
            <span class="n">accuracy_max</span> <span class="o">=</span> <span class="n">accuracy_score</span> 
            <span class="n">result</span> <span class="o">=</span> <span class="n">n_estimators</span>
            <span class="k">if</span> <span class="n">do_print</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;n estimators </span><span class="si">{}</span><span class="s1">: </span><span class="si">{:.2%}</span><span class="s1"> accuracy on validation set.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">n_estimators</span><span class="p">,</span> <span class="n">accuracy_score</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">do_print</span><span class="p">:</span> 
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;-&#39;</span> <span class="o">*</span> <span class="mi">20</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;n estimators </span><span class="si">{}</span><span class="s1"> has </span><span class="si">{:.2%}</span><span class="s1"> accuracy.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">result</span><span class="p">,</span><span class="n">accuracy_max</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">result</span>
    
<span class="n">best_n_estimators</span> <span class="o">=</span> <span class="n">train_and_find_n_estimators</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">X_val</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_val</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>n estimators 1: 57.30% accuracy on validation set.
--------------------
n estimators 2: 57.30% accuracy on validation set.
--------------------
n estimators 3: 59.43% accuracy on validation set.
--------------------
n estimators 4: 60.14% accuracy on validation set.
--------------------
n estimators 5: 62.28% accuracy on validation set.
--------------------
n estimators 6: 62.99% accuracy on validation set.
--------------------
n estimators 7: 64.06% accuracy on validation set.
--------------------
n estimators 8: 65.12% accuracy on validation set.
--------------------
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>n estimators 10: 65.84% accuracy on validation set.
--------------------
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>n estimators 18: 65.84% accuracy on validation set.
--------------------
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>n estimators 24: 66.19% accuracy on validation set.
--------------------
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>n estimators 28: 66.90% accuracy on validation set.
--------------------
n estimators 30: 67.26% accuracy on validation set.
--------------------
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>n estimators 30 has 67.26% accuracy.
</pre></div>
</div>
</div>
</div>
<p>Now let’s try to adjust the min_samples_split parameter which is the minimal number of different data placed in a node before the node is split</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">train_and_find_min_samples_split</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">X_val</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_val</span><span class="p">,</span> <span class="n">do_print</span><span class="p">):</span> 
    <span class="n">result</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">accuracy_max</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
    <span class="k">for</span> <span class="n">min_samples_split</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">20</span><span class="p">):</span>
        <span class="n">dt_model</span> <span class="o">=</span> <span class="n">RandomForestClassifier</span><span class="p">(</span><span class="n">min_samples_split</span><span class="o">=</span><span class="n">min_samples_split</span><span class="p">,</span><span class="n">random_state</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span> 
        <span class="n">dt_model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
        <span class="n">y_pred</span> <span class="o">=</span> <span class="n">dt_model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_val</span><span class="p">)</span>
        <span class="n">accuracy_score</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_val</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">accuracy_score</span> <span class="o">&gt;=</span> <span class="n">accuracy_max</span><span class="p">:</span> 
            <span class="n">accuracy_max</span> <span class="o">=</span> <span class="n">accuracy_score</span> 
            <span class="n">result</span> <span class="o">=</span> <span class="n">min_samples_split</span>
            <span class="k">if</span> <span class="n">do_print</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;min samples split </span><span class="si">{}</span><span class="s1">: </span><span class="si">{:.2%}</span><span class="s1"> accuracy on validation set.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">min_samples_split</span><span class="p">,</span> <span class="n">accuracy_score</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">do_print</span><span class="p">:</span> 
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;-&#39;</span> <span class="o">*</span> <span class="mi">20</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;min samples split </span><span class="si">{}</span><span class="s1"> has </span><span class="si">{:.2%}</span><span class="s1"> accuracy.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">result</span><span class="p">,</span><span class="n">accuracy_max</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">result</span>

<span class="n">min_samples_split</span> <span class="o">=</span> <span class="n">train_and_find_min_samples_split</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">X_val</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_val</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>min samples split 2: 65.12% accuracy on validation set.
--------------------
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>min samples split 3: 65.12% accuracy on validation set.
--------------------
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>min samples split 4: 66.19% accuracy on validation set.
--------------------
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>min samples split 5: 66.55% accuracy on validation set.
--------------------
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>min samples split 7: 66.55% accuracy on validation set.
--------------------
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>min samples split 8: 66.90% accuracy on validation set.
--------------------
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>min samples split 9: 67.97% accuracy on validation set.
--------------------
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>min samples split 19: 68.33% accuracy on validation set.
--------------------
min samples split 19 has 68.33% accuracy.
</pre></div>
</div>
</div>
</div>
<p>Let’s try the max_features parameter. It is the max number of features who are considered when splitting a node.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">train_and_find_max_features</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">X_val</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_val</span><span class="p">,</span> <span class="n">do_print</span><span class="p">):</span> 
    <span class="n">result</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">accuracy_max</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
    <span class="k">for</span> <span class="n">max_features</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">20</span><span class="p">):</span>
        <span class="n">dt_model</span> <span class="o">=</span> <span class="n">RandomForestClassifier</span><span class="p">(</span><span class="n">max_features</span><span class="o">=</span><span class="n">max_features</span><span class="p">,</span><span class="n">random_state</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span> 
        <span class="n">dt_model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
        <span class="n">y_pred</span> <span class="o">=</span> <span class="n">dt_model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_val</span><span class="p">)</span>
        <span class="n">accuracy_score</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_val</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">accuracy_score</span> <span class="o">&gt;=</span> <span class="n">accuracy_max</span><span class="p">:</span> 
            <span class="n">accuracy_max</span> <span class="o">=</span> <span class="n">accuracy_score</span> 
            <span class="n">result</span> <span class="o">=</span> <span class="n">max_features</span>
            <span class="k">if</span> <span class="n">do_print</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;max features split </span><span class="si">{}</span><span class="s1">: </span><span class="si">{:.2%}</span><span class="s1"> accuracy on validation set.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">max_features</span><span class="p">,</span> <span class="n">accuracy_score</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">do_print</span><span class="p">:</span> 
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;-&#39;</span> <span class="o">*</span> <span class="mi">20</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;max features split </span><span class="si">{}</span><span class="s1"> has </span><span class="si">{:.2%}</span><span class="s1"> accuracy.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">result</span><span class="p">,</span><span class="n">accuracy_max</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">result</span>

<span class="n">max_features</span> <span class="o">=</span> <span class="n">train_and_find_max_features</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">X_val</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_val</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>max features split 1: 66.19% accuracy on validation set.
--------------------
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>max features split 9: 68.33% accuracy on validation set.
--------------------
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>max features split 9 has 68.33% accuracy.
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dt_model</span> <span class="o">=</span> <span class="n">RandomForestClassifier</span><span class="p">(</span><span class="n">max_depth</span><span class="o">=</span><span class="n">best_max_depth</span><span class="p">,</span><span class="n">n_estimators</span><span class="o">=</span><span class="n">best_n_estimators</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">min_samples_split</span><span class="o">=</span><span class="n">min_samples_split</span><span class="p">,</span><span class="n">max_features</span><span class="o">=</span><span class="n">max_features</span><span class="p">)</span>
<span class="n">dt_model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<span class="n">y_pred</span> <span class="o">=</span> <span class="n">dt_model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
<span class="n">accuracy_score_imputed</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span> 
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Accuracy: </span><span class="si">{:.2%}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">accuracy_score_imputed</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Accuracy: 71.90%
</pre></div>
</div>
</div>
</div>
<p>Imputing data is not required. The only data that we missed were the Percent of successful 3-Throws of players who did not have any 3 Throws (0)</p>
<p>By using the train-validation test method without any hyperparameters, an accuracy of 65% has been reached. By adding hyperparameters, it rose up to ca. 72%. Which is a little higher than the train-test split method (69.3%).</p>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./chapters"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="DataVisualisation.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Data Visualisation</p>
        </div>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Oliver Sugic, Christoph Handel, Darius Pavelescu<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>